---
title: "2021 S2L Eng Report"
author: "Gloria Liou"
date: "1/22/2022"
output:
  html_document: 
    toc: yes
    fig_width: 20
  pdf_document:
    toc: yes
editor_options: 
  chunk_output_type: inline
---

---
<style>
p {
    font-size: 16px;
    line-height: 24px;
    margin: 0px 0px 12px 0px;
}

h1, h2, h3, h4, h5, h6, legend {
    font-family: Franklin Gothic, regular;
    font-weight: 700;
    color: #8E6F3E;
}
</style>
---


```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(comment = NA, prompt = FALSE, cache = FALSE, echo = TRUE, results = 'asis', fig.width = 10, fig.height = 5)

library(readr)
library(dplyr)
library(plyr)
library(psych)
library(knitr)
library(summarytools)
library(ggplot2)
theme_set(theme_bw())
library(cowplot)
library(qwraps2)
library(plotrix)
library(tinytex)

EPICS <- read_csv("EPICS_2019_cleanedbyFanyi.csv")
ENGR <- read_csv("ENGR_2020_03.csv")
ENG21 <- read_csv("ENG_2021.csv")

# Remove first 2 rows (not data)
ENG21 <- ENG21[-c(1,2), ]

# Remove all graduates student respondents from the dataset:
ENG21 <- ENG21[!ENG21$Year=='6',]
```


#### 0 - DEMOGRAPHICS

```{r demo, echo = FALSE}
st_options(footnote = NA,
           subtitle.emphasis = FALSE)
st_css()

ENG21$Year <- factor(ENG21$Year, levels = c(1, 2, 3, 4, 5),
       labels = c("1st year", "2nd year", "3rd year", "4th year", ">= 5th year"))
ENG21$Gender <- factor(ENG21$sex, levels = c(1,2,3),
                   labels = c("Male", "Female", "Other/Nonbinary"))
ENG21$First_Gen <- factor(ENG21$`1st-gen`, levels = c(1, 2),
                   labels = c("First Gen", "Not First Gen"))
ENG21$International <- factor(ENG21$i18n, levels = c(1, 3),
                       labels = c("International", "Not International"))
ENG21$EPICS_Prog <- factor(ENG21$EPICS, levels = c(1,2),
                    labels = c("EPICS", "Not EPICS"))
ENG21$Latino <- factor(ENG21$latinx, levels = c(1,2),
                labels = c("Latino/a", "Not Latino/a"))

#Remove the race/ethnicity demographic groups with N <= 5 for privacy purposes and because these participants also did not complete the majority of the survey
#American Indian or Alaska Native - 1
#Native Hawaiian or Other Pacific Islander - 4
ENG21 <- ENG21[!(ENG21$Eth == 1 | ENG21$Eth == 4),]

#Relabel participants who did not answer into the "Other or Undisclosed"
#Relabel participants who answered multiple as "Multiracial"
for(i in seq(from = 1, to = 1264, by = 1)) {
  if(is.na(ENG21$Eth[i])) {
    ENG21$Eth[i]<-6
  } else if ((ENG21$Eth[i] != "2") & (ENG21$Eth[i] != "3") & (ENG21$Eth[i] != "5") & (ENG21$Eth[i] != "6")) {
    ENG21$Eth[i]<-0
  }
}

ENG21$Race_Ethnicity <- factor(ENG21$Eth, levels = c(2, 3, 5, 0, 6),
              labels = c("Asian",
                         "Black/African-American",
                         "White",
                         "Multiracial",
                         "Other or Undisclosed"))

#Remove the majors with N <= 5 for privacy purposes and because these participants also did not complete the majority of the survey
#Agricultural Engineering - 2
#Environmental and Natural Resources Engineering - 10
#Interdisciplinary Engineering Studies - 13
ENG21 <- ENG21[!(ENG21$Major == 2 | ENG21$Major == 10 | ENG21$Major == 13),]

#Relabel participants who answered multiple as "Multiple Majors"
for(i in seq(from = 1, to = 1264, by = 1)) {
  if(is.na(ENG21$Major[i])) {
  } else if ((ENG21$Major[i] != "1") & (ENG21$Major[i] != "3") & (ENG21$Major[i] != "19") & (ENG21$Major[i] != "4") & (ENG21$Major[i] != "5") & (ENG21$Major[i] != "6") & (ENG21$Major[i] != "7") & (ENG21$Major[i] != "8") & (ENG21$Major[i] != "9") & (ENG21$Major[i] != "12") & (ENG21$Major[i] != "14") & (ENG21$Major[i] != "15") & (ENG21$Major[i] != "16") & (ENG21$Major[i] != "17") & (ENG21$Major[i] != "11")) {
     ENG21$Major[i]<-0
  }
}

ENG21$Major.01 <- factor(ENG21$Major, levels = c(1, 3, 19, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 17, 0, 11),
              labels = c("Aeronautical and Astronautical Engineering",
                         "Biological Engineering",
                         "Biomedical Engineering",
                         "Chemical Engineering",
                         "Civil Engineering",
                         "Computer Engineering",
                         "Construction Engineering & Management",
                         "Electrical Engineering",
                         "Environmental and Ecological Engineering",
                         "Industrial Engineering",
                         "Materials Engineering",
                         "Mechanical Engineering",
                         "Multidisciplinary Engineering",
                         "Nuclear Engineering",
                         "Multiple Majors",
                         "First Year Engineering"))

demographics <- subset(ENG21, select = c(Year, Gender, Latino, Race_Ethnicity, First_Gen, International, Major.01, EPICS_Prog))
print(dfSummary(demographics, plain.ascii = FALSE,
          report.nas = FALSE, 
          valid.col = FALSE,
          style = "grid", 
          graph.magnif = 0.75, 
          tmp.img.dir = "/tmp"))

```

#### 1 - WELL-BEING
###### 1.1 Life Satisfaction
```{r, Life satisfaction} 

summaryDemo <- function(data=NULL, measurevar, groupvar, na.rm=FALSE){
  var <- ENG21 %>%
    group_by(.data[[groupvar]]) %>%
    dplyr::summarise(mean = mean(.data[[measurevar]], na.rm = TRUE),
              se = std.error(.data[[measurevar]]),
              group = groupvar,
              sample = n())%>%
    dplyr::rename(demo = groupvar)
  return(var)
}

ENG21$WB_1 = as.numeric(as.character(ENG21$WB_1))

life_sat_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("Year")))
life_sat_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("Gender")))
life_sat_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("Latino")))
life_sat_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("Race_Ethnicity")))
life_sat_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("First_Gen")))
life_sat_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("International")))
life_sat_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("Major.01")))
life_sat_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_1", groupvar=c("EPICS_Prog")))

life_sat_21 <- mean(ENG21$WB_1, na.rm=TRUE)
life_sat_20 <- mean(ENGR$WB_1, na.rm=TRUE)
life_sat_19 <- mean(EPICS$SWB_1_1, na.rm=TRUE)

life_sat <- rbind(life_sat_byYear,
                  life_sat_byGen,
                  life_sat_byLat,
                  life_sat_byEth,
                  life_sat_by1stGen,
                  life_sat_byInt,
                  life_sat_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

# Life Satisfaction by Major
life_sat_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(life_sat_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = life_sat_21, colour = "2021 avg: 3.25")) +
  geom_vline(aes(xintercept = life_sat_20, colour = "2020 avg: 3.21")) +
  geom_vline(aes(xintercept = life_sat_19, colour = "2019 avg: 3.71")) +
  scale_colour_manual(values = c("2021 avg: 3.25" = "blueviolet", "2020 avg: 3.21" = "green3", "2019 avg: 3.71" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I am satisfied with my life", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(life_sat_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("life_sat_byMajor.png", width = 10, height = 6)

## Life Satisfaction By Demographic
ggplot(life_sat, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = life_sat_21, colour = "2021 avg: 3.25")) +
  geom_vline(aes(xintercept = life_sat_20, colour = "2020 avg: 3.21")) +
  geom_vline(aes(xintercept = life_sat_19, colour = "2019 avg: 3.71")) +
  scale_colour_manual(values = c("2021 avg: 3.25" = "blueviolet", "2020 avg: 3.21" = "green3", "2019 avg: 3.71" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I am satisfied with my life", x="Mean", y="Demographics") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("life_sat.png", width = 13, height = 6)
```


###### 1.2 Perceived Health Support 

```{r,  Perceived health support}
# MENTAL HEALTH
ENG21$WB_2 = as.numeric(as.character(ENG21$WB_2))

MH_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("Year")))
MH_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("Gender")))
MH_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("Latino")))
MH_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("Race_Ethnicity")))
MH_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("First_Gen")))
MH_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("International")))
MH_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("Major.01"))) 
MH_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_2", groupvar=c("EPICS_Prog")))

MH_21 <- mean(ENG21$WB_2, na.rm=TRUE)
MH_20 <- mean(ENGR$WB_2, na.rm=TRUE)

MH <- rbind(MH_byYear, MH_byGen, MH_byLat, MH_byEth, MH_by1stGen, MH_byInt, MH_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

## Mental Health by Major
MH_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(MH_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = MH_21, colour = "2021 avg: 2.68")) +
  geom_vline(aes(xintercept = MH_20, colour = "2020 avg: 2.59")) +
  scale_colour_manual(values = c("2021 avg: 2.68" = "blueviolet", "2020 avg: 2.59" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Purdue provides support for my mental health", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(MH_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("MH_byMajor.png", width = 10, height = 6)

## Mental Health by Demographic
ggplot(MH, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = MH_21, colour = "2021 avg: 2.68")) +
  geom_vline(aes(xintercept = MH_20, colour = "2020 avg: 2.59")) +
  scale_colour_manual(values = c("2021 avg: 2.68" = "blueviolet", "2020 avg: 2.59" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Purdue provides support for my mental health", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("MH.png", width = 13, height = 6)


# PHYSICAL HEALTH
ENG21$WB_3 = as.numeric(as.character(ENG21$WB_3))

PH_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("Year")))
PH_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("Gender")))
PH_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("Latino")))
PH_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("Race_Ethnicity")))
PH_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("First_Gen")))
PH_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("International")))
PH_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("Major.01"))) 
PH_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "WB_3", groupvar=c("EPICS_Prog")))

PH_21 <- mean(ENG21$WB_3, na.rm=TRUE)
PH_20 <- mean(ENGR$WB_3, na.rm=TRUE)

PH <- rbind(PH_byYear, PH_byGen, PH_byLat, PH_byEth, PH_by1stGen, PH_byInt, PH_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

## Physical Health by Major
MH_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PH_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PH_21, colour = "2021 avg: 3.48")) +
  geom_vline(aes(xintercept = PH_20, colour = "2020 avg: 3.34")) +
  scale_colour_manual(values = c("2021 avg: 3.48" = "blueviolet", "2020 avg: 3.34" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Purdue provides support for my physical health", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PH_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("PH_byMajor.png", width = 10, height = 6)

## Physical Health by Demographic
ggplot(PH, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PH_21, colour = "2021 avg: 3.48")) +
  geom_vline(aes(xintercept = PH_20, colour = "2020 avg: 3.34")) +
  scale_colour_manual(values = c("2021 avg: 3.48" = "blueviolet", "2020 avg: 3.34" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Purdue provides support for my physical health", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("PH.png", width = 13, height = 6)
```

###### 1.3 Health Status

```{r, Perceived health, Sleep, Diet} 
## PERCEIVED HEALTH
ENG21$H_1 = as.numeric(as.character(ENG21$H_1))

PreH_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("Year")))
PreH_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("Gender")))
PreH_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("Latino")))
PreH_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("Race_Ethnicity")))
PreH_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("First_Gen")))
PreH_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("International")))
PreH_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("Major.01"))) 
PreH_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "H_1", groupvar=c("EPICS_Prog")))

PreH_21 <- mean(ENG21$H_1, na.rm=TRUE)
PreH_20 <- mean(ENGR$H_1, na.rm=TRUE)
PreH_19 <- mean(EPICS$SWB_2_1, na.rm=TRUE)

PreH <- rbind(PreH_byYear, PreH_byGen, PreH_byLat, PreH_byEth, PreH_by1stGen, PreH_byInt, PreH_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

## Perceived Health by Major
PreH_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PreH_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PreH_21, colour = "2021 avg: 2.94")) +
  geom_vline(aes(xintercept = PreH_20, colour = "2020 avg: 2.83")) +
  geom_vline(aes(xintercept = PreH_19, colour = "2019 avg: 3.26")) +
  scale_colour_manual(values = c("2021 avg: 2.94" = "blueviolet", "2020 avg: 2.83" = "green3", "2019 avg: 3.26" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Would you say your health in general is...", x="Mean", y="Demographics") + 
  scale_y_discrete(limits = rev(levels(PreH_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("PreH_byMajor.png", width = 10, height = 6)

## Perceived Health by Demographic
ggplot(PreH, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PreH_21, colour = "2021 avg: 2.94")) +
  geom_vline(aes(xintercept = PreH_20, colour = "2020 avg: 2.83")) +
  geom_vline(aes(xintercept = PreH_19, colour = "2019 avg: 3.26")) +
  scale_colour_manual(values = c("2021 avg: 2.94" = "blueviolet", "2020 avg: 2.83" = "green3", "2019 avg: 3.26" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Would you say your health in general is...", x="Mean", y="Demographics") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("PreH.png", width = 13, height = 6)

## SLEEP
ENG21$H_2 = as.numeric(as.character(ENG21$H_2))

Sleep_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("Year")))
Sleep_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("Gender")))
Sleep_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("Latino")))
Sleep_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("Race_Ethnicity")))
Sleep_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("First_Gen")))
Sleep_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("International")))
Sleep_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("Major.01"))) 
Sleep_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "H_2", groupvar=c("EPICS_Prog")))

Sleep_21 <- mean(ENG21$H_2, na.rm=TRUE)
Sleep_20 <- mean(ENGR$H_2, na.rm=TRUE)

Sleep <- rbind(Sleep_byYear, Sleep_byGen, Sleep_byLat, Sleep_byEth, Sleep_by1stGen, Sleep_byInt, Sleep_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

## Comparison by Major: Sleep
Sleep_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(Sleep_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = Sleep_21, colour = "2021 avg: 2.19")) +
  geom_vline(aes(xintercept = Sleep_20, colour = "2020 avg: 2.21")) +
  scale_colour_manual(values = c("2021 avg: 2.19" = "blueviolet", "2020 avg: 2.21" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Would you say your sleep in the past two weeks is...", x="Mean", y="Demographics") + 
  scale_y_discrete(limits = rev(levels(Sleep_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Sleep_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Sleep
ggplot(Sleep, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = Sleep_21, colour = "2021 avg: 2.19")) +
  geom_vline(aes(xintercept = Sleep_20, colour = "2020 avg: 2.21")) +
  scale_colour_manual(values = c("2021 avg: 2.19" = "blueviolet", "2020 avg: 2.21" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Would you say your sleep in the past two weeks is...", x="Mean", y="Demographics") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Sleep.png", width = 13, height = 6)

## DIET
ENG21$H_3 = as.numeric(as.character(ENG21$H_3))

Diet_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("Year")))
Diet_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("Gender")))
Diet_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("Latino")))
Diet_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("Race_Ethnicity")))
Diet_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("First_Gen")))
Diet_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("International")))
Diet_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("Major.01"))) 
Diet_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "H_3", groupvar=c("EPICS_Prog")))

Diet_21 <- mean(ENG21$H_3, na.rm=TRUE)
Diet_20 <- mean(ENGR$H_3, na.rm=TRUE)

Diet <- rbind(Diet_byYear, Diet_byGen, Diet_byLat, Diet_byEth, Diet_by1stGen, Diet_byInt, Diet_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

## Comparison by Major: Diet
Diet_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(Diet_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = Diet_21, colour = "2021 avg: 2.37")) +
  geom_vline(aes(xintercept = Diet_20, colour = "2020 avg: 2.23")) +
  scale_colour_manual(values = c("2021 avg: 2.37" = "blueviolet", "2020 avg: 2.23" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Would you say your diet in the past two weeks is...", x="Mean", y="Demographics") + 
  scale_y_discrete(limits = rev(levels(Diet_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Diet_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Diet
ggplot(Diet, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = Diet_21, colour = "2021 avg: 2.37")) +
  geom_vline(aes(xintercept = Diet_20, colour = "2020 avg: 2.23")) +
  scale_colour_manual(values = c("2021 avg: 2.37" = "blueviolet", "2020 avg: 2.23" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Would you say your diet in the past two weeks is...", x="Mean", y="Demographics") + 
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Poor", "Fair", "Good", "Very Good")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Diet.png", width = 13, height = 6)
```


###### 1.4 Emotions
###### 1.4.0 - Create Emotions Variables
```{r Emotions v2} 
## HAPPY
ENG21$PA_1 = as.numeric(as.character(ENG21$PA_1))
PA_01_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("Year")))
PA_01_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("Gender")))
PA_01_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("Latino")))
PA_01_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("Race_Ethnicity")))
PA_01_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("First_Gen")))
PA_01_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("International")))
PA_01_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("Major.01"))) 
PA_01_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_1", groupvar=c("EPICS_Prog")))

PA_01 <- rbind(PA_01_byYear, PA_01_byGen, PA_01_byLat, PA_01_byEth, PA_01_by1stGen, PA_01_byInt, PA_01_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

PA_01_21 <- mean(ENG21$PA_1, na.rm=TRUE)
PA_01_20 <- mean(ENGR$PA_1, na.rm=TRUE)
PA_01_19 <- mean(EPICS$PANAS_1, na.rm=TRUE)


## DEPRESSED
ENG21$PA_2 = as.numeric(as.character(ENG21$PA_2))
PA_02_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("Year")))
PA_02_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("Gender")))
PA_02_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("Latino")))
PA_02_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("Race_Ethnicity")))
PA_02_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("First_Gen")))
PA_02_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("International")))
PA_02_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("Major.01"))) 
PA_02_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_2", groupvar=c("EPICS_Prog")))

PA_02 <- rbind(PA_02_byYear, PA_02_byGen, PA_02_byLat, PA_02_byEth, PA_02_by1stGen, PA_02_byInt, PA_02_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

PA_02_21 <- mean(ENG21$PA_2, na.rm=TRUE)
PA_02_20 <- mean(ENGR$PA_2, na.rm=TRUE)
PA_02_19 <- mean(EPICS$PANAS_3, na.rm=TRUE)


## STRESSED
ENG21$PA_3 = as.numeric(as.character(ENG21$PA_3))
PA_03_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("Year")))
PA_03_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("Gender")))
PA_03_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("Latino")))
PA_03_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("Race_Ethnicity")))
PA_03_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("First_Gen")))
PA_03_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("International")))
PA_03_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("Major.01"))) 
PA_03_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_3", groupvar=c("EPICS_Prog")))

PA_03 <- rbind(PA_03_byYear, PA_03_byGen, PA_03_byLat, PA_03_byEth, PA_03_by1stGen, PA_03_byInt, PA_03_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

PA_03_21 <- mean(ENG21$PA_3, na.rm=TRUE)
PA_03_20 <- mean(ENGR$PA_3, na.rm=TRUE)
PA_03_19 <- mean(EPICS$PANAS_4, na.rm=TRUE)


## GRATEFUL
ENG21$PA_4 = as.numeric(as.character(ENG21$PA_4))
PA_04_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("Year")))
PA_04_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("Gender")))
PA_04_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("Latino")))
PA_04_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("Race_Ethnicity")))
PA_04_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("First_Gen")))
PA_04_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("International")))
PA_04_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("Major.01"))) 
PA_04_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_4", groupvar=c("EPICS_Prog")))

PA_04 <- rbind(PA_04_byYear, PA_04_byGen, PA_04_byLat, PA_04_byEth, PA_04_by1stGen, PA_04_byInt, PA_04_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

PA_04_21 <- mean(ENG21$PA_4, na.rm=TRUE)
PA_04_20 <- mean(ENGR$PA_4, na.rm=TRUE)
PA_04_19 <- mean(EPICS$PANAS_5, na.rm=TRUE)


## ANXIOUS
ENG21$PA_5 = as.numeric(as.character(ENG21$PA_5))
PA_05_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("Year")))
PA_05_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("Gender")))
PA_05_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("Latino")))
PA_05_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("Race_Ethnicity")))
PA_05_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("First_Gen")))
PA_05_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("International")))
PA_05_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("Major.01"))) 
PA_05_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PA_5", groupvar=c("EPICS_Prog")))

PA_05 <- rbind(PA_05_byYear, PA_05_byGen, PA_05_byLat, PA_05_byEth, PA_05_by1stGen, PA_05_byInt, PA_05_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

PA_05_21 <- mean(ENG21$PA_5, na.rm=TRUE)
PA_05_20 <- mean(ENGR$PA_5, na.rm=TRUE)
```

##### 1.4.1 - "Happy"

```{r}
## Comparison by Major: Happy
PA_01_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PA_01_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PA_01_21, colour = "2021 avg: 3.21")) +
  geom_vline(aes(xintercept = PA_01_20, colour = "2020 avg: 3.09")) +
  geom_vline(aes(xintercept = PA_01_19, colour = "2019 avg: 3.53")) +
  scale_colour_manual(values = c("2021 avg: 3.21" = "blueviolet", "2020 avg: 3.09" = "green3", "2019 avg: 3.53" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="How frequently have you felt happy in the past two weeks on average?", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PA_01_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Happy_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Happy
ggplot(PA_01, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PA_01_21, colour = "2021 avg: 3.21")) +
  geom_vline(aes(xintercept = PA_01_20, colour = "2020 avg: 3.09")) +
  geom_vline(aes(xintercept = PA_01_19, colour = "2019 avg: 3.53")) +
  scale_colour_manual(values = c("2021 avg: 3.21" = "blueviolet", "2020 avg: 3.09" = "green3", "2019 avg: 3.53" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="How frequently have you felt happy in the past two weeks on average?", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Happy.png", width = 13, height = 6)
```


##### 1.4.2 - "Depressed"

```{r}
## Comparison by Major: Depressed
PA_02_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PA_02_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PA_02_21, colour = "2021 avg: 2.91")) +
  geom_vline(aes(xintercept = PA_02_20, colour = "2020 avg: 3.10")) +
  geom_vline(aes(xintercept = PA_02_19, colour = "2019 avg: 2.49")) +
  scale_colour_manual(values = c("2021 avg: 2.91" = "blueviolet", "2020 avg: 3.10" = "green3", "2019 avg: 2.49" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="How frequently have you felt depressed in the past two weeks on average?", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PA_02_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Depressed_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Depressed
ggplot(PA_02, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PA_02_21, colour = "2021 avg: 2.91")) +
  geom_vline(aes(xintercept = PA_02_20, colour = "2020 avg: 3.10")) +
  geom_vline(aes(xintercept = PA_02_19, colour = "2019 avg: 2.49")) +
  scale_colour_manual(values = c("2021 avg: 2.91" = "blueviolet", "2020 avg: 3.10" = "green3", "2019 avg: 2.49" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="How frequently have you felt depressed in the past two weeks on average?", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Depressed.png", width = 13, height = 6)
```


##### 1.4.3 - "Stressed"

```{r}
## Comparison by Major: Stressed
PA_03_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PA_03_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PA_03_21, colour = "2021 avg: 4.10")) +
  geom_vline(aes(xintercept = PA_03_20, colour = "2020 avg: 4.17")) +
  geom_vline(aes(xintercept = PA_03_19, colour = "2019 avg: 3.95")) +
  scale_colour_manual(values = c("2021 avg: 4.10" = "blueviolet", "2020 avg: 4.17" = "green3", "2019 avg: 3.95" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="How frequently have you felt stressed in the past two weeks on average?", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PA_03_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Never", "Rarely", "Sometimes", "Very Often", "Always")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Stressed_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Stressed
ggplot(PA_03, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PA_03_21, colour = "2021 avg: 4.10")) +
  geom_vline(aes(xintercept = PA_03_20, colour = "2020 avg: 4.17")) +
  geom_vline(aes(xintercept = PA_03_19, colour = "2019 avg: 3.95")) +
  scale_colour_manual(values = c("2021 avg: 4.10" = "blueviolet", "2020 avg: 4.17" = "green3", "2019 avg: 3.95" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="How frequently have you felt stressed in the past two weeks on average?", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Never", "Rarely", "Sometimes", "Very Often", "Always")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Stressed.png", width = 13, height = 6)
```


##### 1.4.4 - "Grateful"

```{r}
## Comparison by Major: Grateful
PA_04_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PA_04_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PA_04_21, colour = "2021 avg: 3.29")) +
  geom_vline(aes(xintercept = PA_04_20, colour = "2020 avg: 3.14")) +
  geom_vline(aes(xintercept = PA_04_19, colour = "2019 avg: 3.59")) +
  scale_colour_manual(values = c("2021 avg: 3.29" = "blueviolet", "2020 avg: 3.14" = "green3", "2019 avg: 3.59" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="How frequently have you felt grateful in the past two weeks on average?", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PA_04_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Grateful_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Grateful
ggplot(PA_04, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PA_04_21, colour = "2021 avg: 3.29")) +
  geom_vline(aes(xintercept = PA_04_20, colour = "2020 avg: 3.14")) +
  geom_vline(aes(xintercept = PA_04_19, colour = "2019 avg: 3.59")) +
  scale_colour_manual(values = c("2021 avg: 3.29" = "blueviolet", "2020 avg: 3.14" = "green3", "2019 avg: 3.59" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="How frequently have you felt grateful in the past two weeks on average?", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Never", "Rarely", "Sometimes", "Very Often")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Grateful.png", width = 13, height = 6)
```


##### 1.4.5 - "Anxious"

```{r}
## Comparison by Major: Anxious
PA_05_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(PA_05_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = PA_05_21, colour = "2021 avg: 3.65")) +
  geom_vline(aes(xintercept = PA_05_20, colour = "2020 avg: 3.84")) +
  scale_colour_manual(values = c("2021 avg: 3.65" = "blueviolet", "2020 avg: 3.84" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="How frequently have you felt anxious in the past two weeks on average?", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(PA_05_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Never", "Rarely", "Sometimes", "Very Often", "Always")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Anxious_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Anxious
ggplot(PA_05, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = PA_05_21, colour = "2021 avg: 3.65")) +
  geom_vline(aes(xintercept = PA_05_20, colour = "2020 avg: 3.84")) +
  scale_colour_manual(values = c("2021 avg: 3.65" = "blueviolet", "2020 avg: 3.84" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="How frequently have you felt anxious in the past two weeks on average?", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Never", "Rarely", "Sometimes", "Very Often", "Always")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Anxious.png", width = 13, height = 6)
```



##### 1.5 College Experience
##### 1.5.0 College Experience Variables

```{r} 
## PROFESSOR EXCITED
ENG21$Big6_1 = as.numeric(as.character(ENG21$Big6_1))
CollExp_01_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("Year")))
CollExp_01_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("Gender")))
CollExp_01_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("Latino")))
CollExp_01_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("Race_Ethnicity")))
CollExp_01_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("First_Gen")))
CollExp_01_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("International")))
CollExp_01_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("Major.01"))) 
CollExp_01_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_1", groupvar=c("EPICS_Prog")))

CollExp_01 <- rbind(CollExp_01_byYear, CollExp_01_byGen, CollExp_01_byLat, CollExp_01_byEth, CollExp_01_by1stGen, CollExp_01_byInt, CollExp_01_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_01_21 <- mean(ENG21$Big6_1, na.rm=TRUE)
CollExp_01_20 <- mean(ENGR$Big6_1, na.rm=TRUE)


# PROFESSOR CARED
ENG21$Big6_2 = as.numeric(as.character(ENG21$Big6_2))
CollExp_02_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("Year")))
CollExp_02_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("Gender")))
CollExp_02_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("Latino")))
CollExp_02_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("Race_Ethnicity")))
CollExp_02_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("First_Gen")))
CollExp_02_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("International")))
CollExp_02_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("Major.01"))) 
CollExp_02_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_2", groupvar=c("EPICS_Prog")))

CollExp_02 <- rbind(CollExp_02_byYear, CollExp_02_byGen, CollExp_02_byLat, CollExp_02_byEth, CollExp_02_by1stGen, CollExp_02_byInt, CollExp_02_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_02_21 <- mean(ENG21$Big6_2, na.rm=TRUE)
CollExp_02_20 <- mean(ENGR$Big6_2, na.rm=TRUE)


# MENTOR
ENG21$Big6_3 = as.numeric(as.character(ENG21$Big6_3))
CollExp_03_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("Year")))
CollExp_03_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("Gender")))
CollExp_03_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("Latino")))
CollExp_03_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("Race_Ethnicity")))
CollExp_03_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("First_Gen")))
CollExp_03_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("International")))
CollExp_03_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("Major.01"))) 
CollExp_03_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_3", groupvar=c("EPICS_Prog")))

CollExp_03 <- rbind(CollExp_03_byYear, CollExp_03_byGen, CollExp_03_byLat, CollExp_03_byEth, CollExp_03_by1stGen, CollExp_03_byInt, CollExp_03_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_03_21 <- mean(ENG21$Big6_3, na.rm=TRUE)
CollExp_03_20 <- mean(ENGR$Big6_3, na.rm=TRUE)


# PROJECT
ENG21$Big6_4 = as.numeric(as.character(ENG21$Big6_4))
CollExp_04_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("Year")))
CollExp_04_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("Gender")))
CollExp_04_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("Latino")))
CollExp_04_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("Race_Ethnicity")))
CollExp_04_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("First_Gen")))
CollExp_04_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("International")))
CollExp_04_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("Major.01"))) 
CollExp_04_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_4", groupvar=c("EPICS_Prog")))

CollExp_04 <- rbind(CollExp_04_byYear, CollExp_04_byGen, CollExp_04_byLat, CollExp_04_byEth, CollExp_04_by1stGen, CollExp_04_byInt, CollExp_04_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_04_21 <- mean(ENG21$Big6_4, na.rm=TRUE)
CollExp_04_20 <- mean(ENGR$Big6_4, na.rm=TRUE)


# INTERNSHIP
ENG21$Big6_5 = as.numeric(as.character(ENG21$Big6_5))
CollExp_05_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("Year")))
CollExp_05_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("Gender")))
CollExp_05_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("Latino")))
CollExp_05_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("Race_Ethnicity")))
CollExp_05_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("First_Gen")))
CollExp_05_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("International")))
CollExp_05_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("Major.01"))) 
CollExp_05_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_5", groupvar=c("EPICS_Prog")))

CollExp_05 <- rbind(CollExp_05_byYear, CollExp_05_byGen, CollExp_05_byLat, CollExp_05_byEth, CollExp_05_by1stGen, CollExp_05_byInt, CollExp_05_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_05_21 <- mean(ENG21$Big6_5, na.rm=TRUE)
CollExp_05_20 <- mean(ENGR$Big6_5, na.rm=TRUE)


# EXTRACURRICULARS
ENG21$Big6_6 = as.numeric(as.character(ENG21$Big6_6))
CollExp_06_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("Year")))
CollExp_06_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("Gender")))
CollExp_06_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("Latino")))
CollExp_06_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("Race_Ethnicity")))
CollExp_06_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("First_Gen")))
CollExp_06_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("International")))
CollExp_06_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("Major.01"))) 
CollExp_06_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "Big6_6", groupvar=c("EPICS_Prog")))

CollExp_06 <- rbind(CollExp_06_byYear, CollExp_06_byGen, CollExp_06_byLat, CollExp_06_byEth, CollExp_06_by1stGen, CollExp_06_byInt, CollExp_06_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

CollExp_06_21 <- mean(ENG21$Big6_6, na.rm=TRUE)
CollExp_06_20 <- mean(ENGR$Big6_6, na.rm=TRUE)
```


##### 1.5.1: "I have at least one professor at Purdue University who makes me excited about learning."

```{r}
# PROFESSOR EXCITED: MAJOR
CollExp_01_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_01_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_01_21, colour = "2021 avg: 3.67")) +
  geom_vline(aes(xintercept = CollExp_01_20, colour = "2020 avg: 3.77")) +
  scale_colour_manual(values = c("2021 avg: 3.67" = "blueviolet", "2020 avg: 3.77" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I have at least one professor at Purdue University who makes me excited about learning.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_01_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("ProfExcited_byMajor.png", width = 10, height = 6)

## PROFESSOR EXCITED: DEMOGRAPHICS
ggplot(CollExp_01, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_01_21, colour = "2021 avg: 3.67")) +
  geom_vline(aes(xintercept = CollExp_01_20, colour = "2020 avg: 3.77")) +
  scale_colour_manual(values = c("2021 avg: 3.67" = "blueviolet", "2020 avg: 3.77" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I have at least one professor at Purdue University who makes me excited about learning.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("ProfExcited.png", width = 13, height = 6)
```


##### 1.5.2: "My professors at Purdue University care about me as a person."

```{r}
## PROF CARE: MAJOR
CollExp_02_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_02_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_02_21, colour = "2021 avg: 3.06")) +
  geom_vline(aes(xintercept = CollExp_02_20, colour = "2020 avg: 3.11")) +
  scale_colour_manual(values = c("2021 avg: 3.06" = "blueviolet", "2020 avg: 3.11" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="My professors at Purdue University care about me as a person.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_02_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("ProfCare_byMajor.png", width = 10, height = 6)

## PROF CARE: DEMOGRAPHICS
ggplot(CollExp_02, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_01_21, colour = "2021 avg: 3.06")) +
  geom_vline(aes(xintercept = CollExp_01_20, colour = "2020 avg: 3.11")) +
  scale_colour_manual(values = c("2021 avg: 3.06" = "blueviolet", "2020 avg: 3.11" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="My professors at Purdue University care about me as a person.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("ProfCare.png", width = 13, height = 6)
```

##### 1.5.3: "I have a mentor who encourages me to pursue my goals and dreams."

```{r}
## MENTOR: MAJOR
CollExp_03_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_03_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_03_21, colour = "2021 avg: 2.73")) +
  geom_vline(aes(xintercept = CollExp_03_20, colour = "2020 avg: 2.96")) +
  scale_colour_manual(values = c("2021 avg: 2.73" = "blueviolet", "2020 avg: 2.96" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I have a mentor who encourages me to pursue my goals and dreams.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_03_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Mentor_byMajor.png", width = 10, height = 6)

## MENTOR: DEMOGRAPHICS
ggplot(CollExp_03, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_03_21, colour = "2021 avg: 2.73")) +
  geom_vline(aes(xintercept = CollExp_03_20, colour = "2020 avg: 2.96")) +
  scale_colour_manual(values = c("2021 avg: 2.73" = "blueviolet", "2020 avg: 2.96" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I have a mentor who encourages me to pursue my goals and dreams.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Mentor.png", width = 13, height = 6)
```

##### 1.5.4: "I have worked on a project that took a semester or more to complete."

```{r}
## PROJECT: MAJOR
CollExp_04_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_04_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_04_21, colour = "2021 avg: 2.97")) +
  geom_vline(aes(xintercept = CollExp_04_20, colour = "2020 avg: 3.15")) +
  scale_colour_manual(values = c("2021 avg: 2.97" = "blueviolet", "2020 avg: 3.15" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I have worked on a project that took a semester or more to complete.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_04_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Project_byMajor.png", width = 10, height = 6)

## PROJECT: DEMOGRAPHICS
ggplot(CollExp_04, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_04_21, colour = "2021 avg: 2.97")) +
  geom_vline(aes(xintercept = CollExp_04_20, colour = "2020 avg: 3.15")) +
  scale_colour_manual(values = c("2021 avg: 2.97" = "blueviolet", "2020 avg: 3.15" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I have worked on a project that took a semester or more to complete.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Project.png", width = 13, height = 6)
```

##### 1.5.5: "I have had an internship or job that allowed me to apply what I was learning in the classroom."

```{r}
## INTERNSHIP: MAJOR
CollExp_05_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_05_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_05_21, colour = "2021 avg: 2.57")) +
  geom_vline(aes(xintercept = CollExp_05_20, colour = "2020 avg: 2.72")) +
  scale_colour_manual(values = c("2021 avg: 2.57" = "blueviolet", "2020 avg: 2.72" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I have had an internship or job that allowed me to apply what I was learning in the classroom.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_05_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Internship_byMajor.png", width = 10, height = 6)

## INTERNSHIP: DEMOGRAPHICS
ggplot(CollExp_05, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_05_21, colour = "2021 avg: 2.57")) +
  geom_vline(aes(xintercept = CollExp_05_20, colour = "2020 avg: 2.72")) +
  scale_colour_manual(values = c("2021 avg: 2.57" = "blueviolet", "2020 avg: 2.72" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I have had an internship or job that allowed me to apply what I was learning in the classroom.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Internship.png", width = 13, height = 6)
```

##### 1.5.6: "I have been extremely active in extracurricular activities and organizations at Purdue University."

```{r}
## EXTRA: MAJOR
CollExp_06_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(CollExp_05_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = CollExp_06_21, colour = "2021 avg: 3.14")) +
  geom_vline(aes(xintercept = CollExp_06_20, colour = "2020 avg: 3.17")) +
  scale_colour_manual(values = c("2021 avg: 3.14" = "blueviolet", "2020 avg: 3.17" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="I have been extremely active in extracurricular activities and organizations at Purdue University.", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(CollExp_06_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Extra_byMajor.png", width = 10, height = 6)

## EXTRA: DEMOGRAPHICS
ggplot(CollExp_06, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = CollExp_06_21, colour = "2021 avg: 3.14")) +
  geom_vline(aes(xintercept = CollExp_06_20, colour = "2020 avg: 3.17")) +
  scale_colour_manual(values = c("2021 avg: 3.14" = "blueviolet", "2020 avg: 3.17" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="I have been extremely active in extracurricular activities and organizations at Purdue University.", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5),
                    labels = c("Strongly Disagree", "Disagree",
                               "Neither Agree nor Disagree", "Agree", "Strongly Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Extra.png", width = 13, height = 6)
```


#### 2 - GRIT

##### 2.1 Passion

```{r}  
## Passion
ENG21$PSN = as.numeric(as.character(ENG21$PSN))
Grit_Pass_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("Year")))
Grit_Pass_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("Gender")))
Grit_Pass_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("Latino")))
Grit_Pass_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("Race_Ethnicity")))
Grit_Pass_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("First_Gen")))
Grit_Pass_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("International")))
Grit_Pass_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("Major.01"))) 
Grit_Pass_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PSN", groupvar=c("EPICS_Prog")))

Grit_Pass <- rbind(Grit_Pass_byYear, Grit_Pass_byGen, Grit_Pass_byLat, Grit_Pass_byEth, Grit_Pass_by1stGen, Grit_Pass_byInt, Grit_Pass_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

Grit_Pass_21 <- mean(ENG21$PSN, na.rm=TRUE)
Grit_Pass_20 <- mean(ENGR$PSN, na.rm=TRUE)


## Comparison by Major: Grit-Passion
Grit_Pass_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(Grit_Pass_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = Grit_Pass_21, colour = "2021 avg: 3.44")) +
  geom_vline(aes(xintercept = Grit_Pass_20, colour = "2020 avg: 3.31")) +
  scale_colour_manual(values = c("2021 avg: 3.44" = "blueviolet", "2020 avg: 3.31" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Grit - Passion Scale", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(Grit_Pass_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 6)) +
  scale_x_continuous(breaks = c(1:6), labels = c("Stage 1", "Stage 2", "Stage 3", "Stage 4", "Stage 5", "Stage 6")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Passion_byMajor.png", width = 10, height = 6)

## Comparison by Demographics: Grit-Passion
ggplot(Grit_Pass, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = Grit_Pass_21, colour = "2021 avg: 3.44")) +
  geom_vline(aes(xintercept = Grit_Pass_20, colour = "2020 avg: 3.31")) +
  scale_colour_manual(values = c("2021 avg: 3.44" = "blueviolet", "2020 avg: 3.31" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Grit - Passion Scale", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 6)) +
  scale_x_continuous(breaks = c(1:6),
                    labels = c("Stage 1", "Stage 2", "Stage 3", "Stage 4", "Stage 5", "Stage 6")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Passion.png", width = 13, height = 6)
```

##### 2.2 Perserverance

```{r} 
## Perseverance
ENG21$PSV = as.numeric(as.character(ENG21$PSV))
Grit_Persv_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("Year")))
Grit_Persv_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("Gender")))
Grit_Persv_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("Latino")))
Grit_Persv_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("Race_Ethnicity")))
Grit_Persv_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("First_Gen")))
Grit_Persv_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("International")))
Grit_Persv_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("Major.01"))) 
Grit_Persv_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "PSV", groupvar=c("EPICS_Prog")))

Grit_Persv <- rbind(Grit_Persv_byYear, Grit_Persv_byGen, Grit_Persv_byLat, Grit_Persv_byEth, Grit_Persv_by1stGen, Grit_Persv_byInt, Grit_Persv_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit

Grit_Persv_21 <- mean(ENG21$PSV, na.rm=TRUE)
Grit_Persv_20 <- mean(ENGR$PSV, na.rm=TRUE)


## Comparison by Major: Grit-Perseverance
Grit_Persv_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(Grit_Persv_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = Grit_Persv_21, colour = "2021 avg: 3.88")) +
  geom_vline(aes(xintercept = Grit_Persv_20, colour = "2020 avg: 3.83")) +
  scale_colour_manual(values = c("2021 avg: 3.88" = "blueviolet", "2020 avg: 3.83" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Grit - Perseverance Scale", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(Grit_Persv_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 6)) +
  scale_x_continuous(breaks = c(1:6), labels = c("Stage 1", "Stage 2", "Stage 3", "Stage 4", "Stage 5", "Stage 6")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("Pers_byMajor.png", width = 10, height = 6)

## Comparison by Demographics: Grit-Perseverance
ggplot(Grit_Persv, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = Grit_Persv_21, colour = "2021 avg: 3.88")) +
  geom_vline(aes(xintercept = Grit_Persv_20, colour = "2020 avg: 3.83")) +
  scale_colour_manual(values = c("2021 avg: 3.88" = "blueviolet", "2020 avg: 3.83" = "green3")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Grit - Perseverance Scale", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 6)) +
  scale_x_continuous(breaks = c(1:6),
                    labels = c("Stage 1", "Stage 2", "Stage 3", "Stage 4", "Stage 5", "Stage 6")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("Persv.png", width = 13, height = 6)
```


#### 3 - IMPACT

```{r}
# Create 2021 Impact Score
ENG21.IMP <- data.frame(ENG21$IMP_1, ENG21$IMP_2, ENG21$IMP_3, ENG21$IMP_4, ENG21$IMP_5, ENG21$IMP_6)
ENG21.IMP.list <- list(ENG21.IMP = c(1, 2,-3, 4, 5, 6))
ENG21.IMP.scores <- scoreItems(ENG21.IMP.list, ENG21.IMP, impute = FALSE)
describe(ENG21.IMP.scores$scores)
summary(ENG21.IMP.scores$scores)
ENG21.IMP.scores$alpha
# alpha is .80
ENG21.IMP.scores <- ENG21.IMP.scores$scores
ENG21$ENG21.IMP.composite <- ENG21.IMP.scores[,]

# Create Graph Variables 
IMP_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("Year")))
IMP_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("Gender")))
IMP_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("Latino")))
IMP_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("Race_Ethnicity")))
IMP_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("First_Gen")))
IMP_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("International")))
IMP_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("Major.01"))) 
IMP_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.IMP.composite", groupvar=c("EPICS_Prog")))
IMP <- rbind(IMP_byYear, IMP_byGen, IMP_byLat, IMP_byEth, IMP_by1stGen, IMP_byInt, IMP_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit
IMP_21 <- mean(ENG21$ENG21.IMP.composite, na.rm=TRUE)


## Comparison by Major: Impact
IMP_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(IMP_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = IMP_21, colour = "2021 avg: 3.53")) +
  geom_vline(aes(xintercept = 3.48, colour = "2020 avg: 3.48")) +
  geom_vline(aes(xintercept = 3.55, colour = "2019 avg: 3.55")) +
  scale_colour_manual(values = c("2021 avg: 3.53" = "blueviolet", "2020 avg: 3.48" = "green3", "2019 avg: 3.55" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Composite Impact Score", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(IMP_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("IMP_byMajor.png", width = 10, height = 6)

## Comparison by Demographics: Impact
ggplot(IMP, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = IMP_21, colour = "2021 avg: 3.53")) +
  geom_vline(aes(xintercept = 3.48, colour = "2020 avg: 3.48")) +
  geom_vline(aes(xintercept = 3.55, colour = "2019 avg: 3.55")) +
  scale_colour_manual(values = c("2021 avg: 3.53" = "blueviolet", "2020 avg: 3.48" = "green3", "2019 avg: 3.55" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Composite Impact Score", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("IMP.png", width = 13, height = 6)
```


#### 4 - NETWORKS

```{r}
# Create 2021 Networks score 
ENG21.NET <- data.frame(ENG21$NET_1, ENG21$NET_2, ENG21$NET_3, ENG21$NET_4, ENG21$NET_5, ENG21$NET_6, ENG21$NET_7, ENG21$NET_8, ENG21$NET_9)
ENG21.NET.list <- list(ENG21.NET = c(1, 2, 3, 4, 5, 6, -7, 8, -9))
ENG21.NET.scores <- scoreItems(ENG21.NET.list, ENG21.NET, impute = FALSE)
describe(ENG21.NET.scores$scores)
summary(ENG21.NET.scores$scores)
ENG21.NET.scores$alpha
# alpha is .77
ENG21.NET.scores <- ENG21.NET.scores$scores
ENG21$ENG21.NET.composite <- ENG21.NET.scores[,]

# Create Graph Variables
NET_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("Year")))
NET_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("Gender")))
NET_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("Latino")))
NET_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("Race_Ethnicity")))
NET_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("First_Gen")))
NET_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("International")))
NET_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("Major.01"))) 
NET_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.NET.composite", groupvar=c("EPICS_Prog")))
NET <- rbind(NET_byYear, NET_byGen, NET_byLat, NET_byEth, NET_by1stGen, NET_byInt, NET_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit
NET_21 <- mean(ENG21$ENG21.NET.composite, na.rm=TRUE)

# Comparison by Major: Networks
NET_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(NET_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = NET_21, colour = "2021 avg: 3.49")) +
  geom_vline(aes(xintercept = 3.42, colour = "2020 avg: 3.42")) +
  geom_vline(aes(xintercept = 3.84, colour = "2019 avg: 3.84")) +
  scale_colour_manual(values = c("2021 avg: 3.49" = "blueviolet", "2020 avg: 3.42" = "green3", "2019 avg: 3.84" = "red2")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Composite Networks Score", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(NET_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("NET_byMajor.png", width = 10, height = 6)

## Comparison by Demographics: Networks
ggplot(NET, mapping = aes(x=mean, y=group, fill = reorder(demo, desc(demo)))) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label = mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9)) +
  geom_text(aes(label = demo, x = 1.5), position=position_dodge(width=0.9)) +
  geom_vline(aes(xintercept = NET_21, colour = "2021 avg: 3.49")) +
  geom_vline(aes(xintercept = 3.42, colour = "2020 avg: 3.42")) +
  geom_vline(aes(xintercept = 3.84, colour = "2019 avg: 3.84")) +
  scale_colour_manual(values = c("2021 avg: 3.49" = "blueviolet", "2020 avg: 3.42" = "green3", "2019 avg: 3.84" = "red2")) +
  labs(fill="Demographic Group", colour="Yearly Average") +
  labs(title="Composite Networks Score", x="Mean", y="Demographics") +
  guides(fill = guide_legend(reverse=TRUE)) +
  coord_cartesian(xlim = c(1, 4)) +
  scale_x_continuous(breaks = c(1:4), labels = c("Strongly Disagree", "Disagree", 
                                                 "Neither Agree nor Disagree", "Agree")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  scale_fill_manual(values = c("Not EPICS" = "grey60", "EPICS" = "grey80", "Not First Gen" = "dodgerblue3", "First Gen" = "dodgerblue1", "Other/Nonbinary" = "seagreen4", "Female" = "seagreen3", "Male" = "seagreen2", "Not International" = "deepskyblue3", "International" = "deepskyblue1", "Not Latino/a" = "darkorange3", "Latino/a" = "darkorange1", "Other or Undisclosed" = "coral2", "Multiracial" = "coral1", "White" = "coral3", "Black/African-American" = "coral2", "Asian" = "coral1", ">= 5th year" = "grey50", "4th year" = "grey 60", "3rd year" = "grey70", "2nd year" = "grey80", "1st year" = "grey90"))
  ggsave("NET.png", width = 13, height = 6)
```


#### 5 - LEADERSHIP AND PROFESSIONAL DEVELOPMENT

##### 5.1 Leadership Self-Efficacy
##### START HERE

```{r}  
# Create 2021 Leadership Self-Efficacy Score
ENG21.LSE <- data.frame(ENG21$LSE_1, ENG21$LSE_2, ENG21$LSE_3, ENG21$LSE_4, ENG21$LSE_5, ENG21$LSE_6)
ENG21.LSE.list <- list(ENG21.LSE = c(1,2,3,4,5,6))
ENG21.LSE.scores <- scoreItems(ENG21.LSE.list, ENG21.LSE, impute = FALSE)
describe(ENG21.LSE.scores$scores)
ENG21.LSE.scores$scores[ENG21.LSE.scores$missing > 0] <- NA
describe(ENG21.LSE.scores$scores)
summary(ENG21.LSE.scores$scores)
ENG21.LSE.scores$alpha
# alpha is .89
ENG21.LSE.scores <- ENG21.LSE.scores$scores
ENG21$ENG21.LSE.composite <- ENG21.LSE.scores[,]

# Create Graph Variables
LSE_byYear <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("Year")))
LSE_byGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("Gender")))
LSE_byLat <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("Latino")))
LSE_byEth <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("Race_Ethnicity")))
LSE_by1stGen <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("First_Gen")))
LSE_byInt <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("International")))
LSE_byMajor <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("Major.01"))) 
LSE_byEPICS <- as.data.frame(summaryDemo(ENG21, measurevar = "ENG21.LSE.composite", groupvar=c("EPICS_Prog")))
LSE <- rbind(LSE_byYear, LSE_byGen, LSE_byLat, LSE_byEth, LSE_by1stGen, LSE_byInt, LSE_byEPICS) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit
LSE_21 <- mean(ENG21$ENG21.LSE.composite, na.rm=TRUE)


## Comparison by Major: Leadership self-efficacy
LSE_byMajor %>%
  filter(!is.na(demo)) %>%
  ggplot(LSE_byMajor, mapping = aes(x= mean, y= demo, fill= demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(aes(xintercept = LSE_21, colour = "2021 avg: 68.31")) +
  geom_vline(aes(xintercept = 66.28, colour = "2020 avg: 66.28")) +
  scale_colour_manual(values = c("2021 avg: 68.31" = "blueviolet", "2020 avg: 66.28" = "green3")) +
  labs(fill="Major Type", colour="Yearly Average") +
  labs(title="Leadership Self-Efficacy", x="Mean", y="Demographics") +
  scale_y_discrete(limits = rev(levels(LSE_byMajor$demo))) +
  coord_cartesian(xlim = c(1, 5)) +
  scale_x_continuous(breaks = c(1:5), labels = c("0", "25", "50", "75", "100")) +
  theme(axis.text.x = element_text(angle=0, hjust=.5)) +
  geom_text(aes(label = sample, x = 1.15), position=position_dodge(width=0.9))
  ggsave("LSE_byMajor.png", width = 10, height = 6)

## Comparison by Demographic: Leadership self-efficacy
ggplot(LSE, aes(x=mean, y=demo, fill = demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label=mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = .15)) +
  geom_vline(xintercept = LSE_21, color = "orange") +
  labs(title="Leadership self-efficacy", x="Demographics", y="Mean") + 
  theme(legend.position = "top", axis.text.x = element_text(angle=45, hjust=1)) +
  scale_fill_manual(values = c("First Gen" = "coral1", "Not First Gen" = "coral3",
"EPICS" = "dodgerblue1","Not EPICS" = "dodgerblue3","On campus" = "chocolate","Virtual" = "chocolate4","Male" = "deepskyblue1","Female" = "deepskyblue3","Other" = "deepskyblue4","1st year" = "grey90","2nd year" = "grey80", 
"3rd year" = "grey70","4th year" = "grey 60","> 5 years" = "grey50","Graduate student" = "grey40", "Asian" = "coral1", "African-American" = "coral2",  "White" = "coral3", "Latino" = "coral4"))
```


##### 3.2 Perspective-taking

```{r} 
# Create 2020 Perspective Taking Variable
ENGR.PS.2020 <- data.frame(ENGR$PER_2, ENGR$PER_3)
ENGR.PS.list <- list(ENGR.PS.2020 = c(1,2))
ENGR.PS.scores <- scoreItems(ENGR.PS.list, ENGR.PS.2020, impute = FALSE)
describe(ENGR.PS.scores$scores)
summary(ENGR.PS.scores$scores)
ENGR.PS.scores$alpha
# alpha is .50
ENGR.PS.scores <- ENGR.PS.scores$scores
ENGR$ENGR.PS.composite <- ENGR.PS.scores[,]


# Create 2019 Perspective Taking Variable
EPICS.PS.2019 <- data.frame(EPICS$CIVIC_1, EPICS$CIVIC_2, EPICS$CIVIC_3)
EPICS.PS.list <- list(EPICS.PS.2019 = c(1, 2, 3))
EPICS.PS.scores <- scoreItems(EPICS.PS.list, EPICS.PS.2019, impute = FALSE)
describe(EPICS.PS.scores$scores)
summary(EPICS.PS.scores$scores)
EPICS.PS.scores$alpha
# alpha is .77
EPICS.PS.scores <- EPICS.PS.scores$scores
EPICS$EPICS.PS.composite <- EPICS.PS.scores[,]

PS_byYear <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("Year")))
PS_byEPICS <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("EPICS")))
PS_by1stGen <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("X1st.gen")))
PS_byGen <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("sex")))
PS_byFormat <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("format")))
PS_byEth <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("Eth.RC.c")))
PS_Major <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.PS.composite", groupvar=c("Major.04"))) 
PS <- rbind(PS_by1stGen, PS_byEPICS, PS_byFormat, PS_byGen, PS_byYear, PS_byEth) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit
PS_20 <- mean(ENGR$ENGR.PS.composite, na.rm=TRUE)
PS_19 <- mean(EPICS$EPICS.PS.composite, na.rm=TRUE)


## Comparison by Major: Perspective Taking
ggplot(PS_Major, aes(x= mean, y= demo, fill = demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(xintercept = PS_20, color = "orange") +
  geom_vline(xintercept = PS_19, color = "red") +
  labs(title="Perspective Taking", x="Demographics", y="Mean") + 
  theme(axis.text.x = element_text(angle=0, hjust=1)) +
  geom_text(aes(label = sample, x = .15))

## Comparison by Demographic: Perspective Taking
ggplot(PS, aes(x=mean, y=demo, fill = demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label=mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = .15)) +
  geom_vline(xintercept = PS_20, color = "orange") +
  geom_vline(xintercept = PS_19, color = "red") +
  labs(title="Perspective Taking", x="Demographics", y="Mean") + 
  theme(legend.position = "top", axis.text.x = element_text(angle=45, hjust=1)) +
  scale_fill_manual(values = c("First Gen" = "coral1", "Not First Gen" = "coral3",
"EPICS" = "dodgerblue1","Not EPICS" = "dodgerblue3","On campus" = "chocolate","Virtual" = "chocolate4","Male" = "deepskyblue1","Female" = "deepskyblue3","Other" = "deepskyblue4","1st year" = "grey90","2nd year" = "grey80", 
"3rd year" = "grey70","4th year" = "grey 60","> 5 years" = "grey50","Graduate student" = "grey40", "Asian" = "coral1", "African-American" = "coral2",  "White" = "coral3", "Latino" = "coral4"))
```

##### 3.3 Opportunities to take on leadership and professional experiences

```{r}
ENGR.Opportunities <- data.frame(ENGR$OPP_1, ENGR$OPP_2, ENGR$OPP_3, ENGR$OPP_4)
ENGR.Opportunities.list <- list(ENGR.Opportunities = c(1,2,3,4))
ENGR.Opportunities.scores <- scoreItems(ENGR.Opportunities.list, ENGR.Opportunities, impute = FALSE)
describe(ENGR.Opportunities.scores$scores)
#ENGR.Opportunities.scores$scores[ENGR.Opportunities.scores$missing > 0] <- NA
#describe(ENGR.Opportunities.scores$scores)
summary(ENGR.Opportunities.scores$scores)
ENGR.Opportunities.scores$alpha
# alpha is .739
ENGR.Opportunities.scores <- ENGR.Opportunities.scores$scores
ENGR$ENGR.Opportunities.composite <- ENGR.Opportunities.scores[,]

OPP_byYear <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("Year")))
OPP_byEPICS <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("EPICS")))
OPP_by1stGen <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("X1st.gen")))
OPP_byGen <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("sex")))
OPP_byFormat <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("format")))
OPP_byEth <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("Eth.RC.c")))
OPP_Major <- as.data.frame(summaryDemo(ENGR, measurevar = "ENGR.Opportunities.composite", groupvar=c("Major.04"))) 
OPP <- rbind(OPP_by1stGen, OPP_byEPICS, OPP_byFormat, OPP_byGen, OPP_byYear, OPP_byEth) %>%
  mutate_at(2:3, round, 2) %>%
  na.omit
OPP_20 <- mean(ENGR$ENGR.Opportunities.composite, na.rm=TRUE)

## Comparison by Major: Opportunities to take on leadership and professional experiences
ggplot(OPP_Major, aes(x= mean, y= demo, fill = demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label= round (mean,2)), 
            position=position_dodge(width=0.9), vjust=-.25) +
  geom_vline(xintercept = OPP_20, color = "orange") +
  labs(title="Opportunities to take on leadership and professional experiences", x="Demographics", y="Mean") + 
  theme(axis.text.x = element_text(angle=0, hjust=1)) +
  geom_text(aes(label = sample, x = .15))

## Comparison by Demographic: Opportunities to take on leadership and professional experiences
ggplot(OPP, aes(x=mean, y=demo, fill = demo)) +
  geom_bar(position=position_dodge(), stat="identity") +
  geom_errorbar(aes(xmin=mean-se, xmax=mean+se), width=.1,
                    position=position_dodge(.9)) +
  geom_text(aes(label=mean), position=position_dodge(width=0.9), vjust=-.25) +
  geom_text(aes(label = sample, x = .15)) +
  geom_vline(xintercept = OPP_20, color = "orange") +
  labs(title="Opportunities to take on leadership and professional experiences", x="Demographics", y="Mean") + 
  theme(legend.position = "top", axis.text.x = element_text(angle=45, hjust=1)) +
  scale_fill_manual(values = c("First Gen" = "coral1", "Not First Gen" = "coral3",
"EPICS" = "dodgerblue1","Not EPICS" = "dodgerblue3","On campus" = "chocolate","Virtual" = "chocolate4","Male" = "deepskyblue1","Female" = "deepskyblue3","Other" = "deepskyblue4","1st year" = "grey90","2nd year" = "grey80", 
"3rd year" = "grey70","4th year" = "grey 60","> 5 years" = "grey50","Graduate student" = "grey40", "Asian" = "coral1", "African-American" = "coral2",  "White" = "coral3", "Latino" = "coral4"))
```


